---
categories: Gym NS3
---
# 总体架构

# 文件位置

## Agent运行脚本

理论上，关于Agent的运行脚本比如`simple_test.py`一般放于`ns3gym/scratch`目录下，因为该目录一般用来放置用户定义的脚本。

在强化学习中，该脚本扮演一个Agent的角色，其与使用**Python编写的环境脚本进行交互**，大多数情况下，`ns3`模拟脚本与其放在同一个位置下，当该脚本运行时，模拟脚本被使用`./waf --run "<args>"`自动调用编译执行。

该脚本内容大致如下：

```python
env = gym.make('ns3-v0')
env.reset()

ob_space = env.observation_space
ac_space = env.action_space
print("Observation space: ", ob_space,  ob_space.dtype)
print("Action space: ", ac_space, ac_space.dtype)

stepIdx = 0

try:
    obs = env.reset()
    print("Step: ", stepIdx)
    print("---obs: ", obs)

    while True:
        stepIdx += 1

        action = env.action_space.sample()
        print("---action: ", action)
        obs, reward, done, info = env.step(action)

        print("Step: ", stepIdx)
        print("---obs, reward, done, info: ", obs, reward, done, info)

        if done:
            break
```

## 环境脚本（Gym端）

Gym端的环境脚本使用Python进行编写，以脚本`ns3env.py`为例，该脚本位于`/usr/local/lib/python3.6/dist-packages/ns3gym`目录下，通常在该脚本中**定义Gym环境类**，当然**与ns3端交互的类代码**往往也定义于这个文件中。

编写好这个文件后，最好在同目录下的`__init__.py`文件中注册环境。

该脚本内容大致如下：

```python
# 与ns3通过zmq进行通信
class Ns3ZmqBridge(object):
    """docstring for Ns3ZmqBridge"""
    def __init__(self, port=0, startSim=True, simSeed=0, simArgs={}, debug=False):

# 环境类
class Ns3Env(gym.Env):
    def __init__(self, stepTime=0, port=0, startSim=True, simSeed=0, simArgs={}, debug=False):
```

## 模拟脚本

该脚本与Agent运行脚本通常位于同一个目录下，方便编译。

该脚本使用`C++`语言进行编写，